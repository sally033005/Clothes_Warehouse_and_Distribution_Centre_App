<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">

<head>
    <title>Dashboard - Sally's Clothes Warehouse</title>
    <link rel="stylesheet" th:href="@{/styles/styles.css}" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body class="dashboard-body">

    <!-- Sidebar -->
    <nav class="sidebar">
        <div class="sidebar-header">
            <div class="logo-area">
                <img th:src="@{/images/logo.png}" alt="Sally's Logo" class="sidebar-logo">
                <span>SALLY'S</span>
            </div>
        </div>
        <ul class="sidebar-menu">
            <li><a th:href="@{/}" class="active"><i class="fas fa-home"></i> Dashboard</a></li>
            <li>
                <a th:href="@{/items}">
                    <i class="fas fa-list"></i> Items
                    <span class="badge badge-danger" th:if="${lowStockCount > 0}" th:text="${lowStockCount}">0</span>
                </a>
            </li>
            <li><a th:href="@{/admin/distribution-centres}"><i class="fas fa-truck"></i> View DC</a></li>
        </ul>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Top Header -->
        <header class="dashboard-header">
            <h2>Dashboard</h2>
            <div class="header-right">
                <span class="welcome-text">Welcome, <span th:text="${username}">User</span></span>
                <form th:action="@{/logout}" method="post" class="logout-form-dashboard">
                    <button type="submit" class="btn-logout">Logout</button>
                </form>
            </div>
        </header>

        <!-- Priorities Section -->
        <div class="priorities-section card">
            <div class="priority-header">
                <h3><i class="fas fa-exclamation-triangle text-warning"></i> Today's Priorities</h3>
                <i class="fas fa-chevron-right"></i>
            </div>
            <div class="priorities-grid">
                <div class="priority-item">
                    <i class="fas fa-exclamation-circle text-danger"></i>
                    <div>
                        <span class="priority-count text-danger">Critical Stock</span>
                    </div>
                </div>
                <div class="priority-item">
                    <i class="fas fa-check-circle text-success"></i>
                    <div>
                        <span class="priority-count" th:text="${mockAwaitingApproval}">0</span>
                        <span> awaiting approval - <a href="#">Review requests &rarr;</a></span>
                    </div>
                </div>
                <div class="priority-item">
                    <i class="fas fa-truck text-primary-dark"></i>
                    <div>
                        <span class="priority-count" th:text="${mockReadyForShipment}">0</span>
                        <span> ready for shipment - <a href="#">View shipments &rarr;</a></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Recent Activities -->
            <div class="card recent-activities">
                <div class="card-header-flex">
                    <h3>Recent Activities</h3>
                    <i class="fas fa-chevron-right"></i>
                </div>
                <ul class="activity-list">
                    <li th:each="activity : ${recentActivities}">
                        <span class="activity-dot"
                            th:classappend="${activity.contains('added') ? 'dot-blue' : (activity.contains('edited') ? 'dot-yellow' : 'dot-green')}"></span>
                        <span th:text="${activity}">Activity log...</span>
                    </li>
                </ul>
            </div>

            <!-- Low Stock Items -->
            <div class="card low-stock-table-card">
                <h3>Low Stock Items</h3>
                <div class="table-responsive">
                    <table class="dashboard-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Item Name</th>
                                <th>Stock</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="item : ${lowStockItems}">
                                <td th:text="${item.id}">123</td>
                                <td th:text="${item.name}">Item Name</td>
                                <td th:text="${item.quantity} + ' units'">0 units</td>
                                <td>
                                    <a th:href="@{/admin/request-item(itemName=${item.name}, brand=${item.brand})}"
                                        class="btn-request">Request</a>
                                </td>
                            </tr>
                            <tr th:if="${#lists.isEmpty(lowStockItems)}">
                                <td colspan="4" class="text-center">No low stock items.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="card-footer">
                    <a th:href="@{/admin/request-item}" class="btn btn-primary btn-block"><i class="fas fa-search"></i>
                        Quick Request</a>
                </div>
            </div>
        </div>
    </div>
</body>

</html>